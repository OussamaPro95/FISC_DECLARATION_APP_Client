{"ast":null,"code":"var __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) {\n        if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __spreadArrays = this && this.__spreadArrays || function () {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) {\n    s += arguments[i].length;\n  }\n\n  for (var r = Array(s), k = 0, i = 0; i < il; i++) {\n    for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++) {\n      r[k] = a[j];\n    }\n  }\n\n  return r;\n};\n\nexport var DAYS_OF_WEEK;\n\n(function (DAYS_OF_WEEK) {\n  DAYS_OF_WEEK[DAYS_OF_WEEK[\"SUNDAY\"] = 0] = \"SUNDAY\";\n  DAYS_OF_WEEK[DAYS_OF_WEEK[\"MONDAY\"] = 1] = \"MONDAY\";\n  DAYS_OF_WEEK[DAYS_OF_WEEK[\"TUESDAY\"] = 2] = \"TUESDAY\";\n  DAYS_OF_WEEK[DAYS_OF_WEEK[\"WEDNESDAY\"] = 3] = \"WEDNESDAY\";\n  DAYS_OF_WEEK[DAYS_OF_WEEK[\"THURSDAY\"] = 4] = \"THURSDAY\";\n  DAYS_OF_WEEK[DAYS_OF_WEEK[\"FRIDAY\"] = 5] = \"FRIDAY\";\n  DAYS_OF_WEEK[DAYS_OF_WEEK[\"SATURDAY\"] = 6] = \"SATURDAY\";\n})(DAYS_OF_WEEK || (DAYS_OF_WEEK = {}));\n\nvar DEFAULT_WEEKEND_DAYS = [DAYS_OF_WEEK.SUNDAY, DAYS_OF_WEEK.SATURDAY];\nvar DAYS_IN_WEEK = 7;\nvar HOURS_IN_DAY = 24;\nvar MINUTES_IN_HOUR = 60;\nexport var SECONDS_IN_DAY = 60 * 60 * 24;\n\nfunction getExcludedSeconds(dateAdapter, _a) {\n  var startDate = _a.startDate,\n      seconds = _a.seconds,\n      excluded = _a.excluded,\n      precision = _a.precision;\n\n  if (excluded.length < 1) {\n    return 0;\n  }\n\n  var addSeconds = dateAdapter.addSeconds,\n      getDay = dateAdapter.getDay,\n      addDays = dateAdapter.addDays;\n  var endDate = addSeconds(startDate, seconds - 1);\n  var dayStart = getDay(startDate);\n  var dayEnd = getDay(endDate);\n  var result = 0; // Calculated in seconds\n\n  var current = startDate;\n\n  var _loop_1 = function _loop_1() {\n    var day = getDay(current);\n\n    if (excluded.some(function (excludedDay) {\n      return excludedDay === day;\n    })) {\n      result += calculateExcludedSeconds(dateAdapter, {\n        dayStart: dayStart,\n        dayEnd: dayEnd,\n        day: day,\n        precision: precision,\n        startDate: startDate,\n        endDate: endDate\n      });\n    }\n\n    current = addDays(current, 1);\n  };\n\n  while (current < endDate) {\n    _loop_1();\n  }\n\n  return result;\n}\n\nfunction calculateExcludedSeconds(dateAdapter, _a) {\n  var precision = _a.precision,\n      day = _a.day,\n      dayStart = _a.dayStart,\n      dayEnd = _a.dayEnd,\n      startDate = _a.startDate,\n      endDate = _a.endDate;\n  var differenceInSeconds = dateAdapter.differenceInSeconds,\n      endOfDay = dateAdapter.endOfDay,\n      startOfDay = dateAdapter.startOfDay;\n\n  if (precision === 'minutes') {\n    if (day === dayStart) {\n      return differenceInSeconds(endOfDay(startDate), startDate) + 1;\n    } else if (day === dayEnd) {\n      return differenceInSeconds(endDate, startOfDay(endDate)) + 1;\n    }\n  }\n\n  return SECONDS_IN_DAY;\n}\n\nfunction getWeekViewEventSpan(dateAdapter, _a) {\n  var event = _a.event,\n      offset = _a.offset,\n      startOfWeekDate = _a.startOfWeekDate,\n      excluded = _a.excluded,\n      precision = _a.precision,\n      totalDaysInView = _a.totalDaysInView;\n  var max = dateAdapter.max,\n      differenceInSeconds = dateAdapter.differenceInSeconds,\n      addDays = dateAdapter.addDays,\n      endOfDay = dateAdapter.endOfDay,\n      differenceInDays = dateAdapter.differenceInDays;\n  var span = SECONDS_IN_DAY;\n  var begin = max([event.start, startOfWeekDate]);\n\n  if (event.end) {\n    switch (precision) {\n      case 'minutes':\n        span = differenceInSeconds(event.end, begin);\n        break;\n\n      default:\n        span = differenceInDays(addDays(endOfDay(event.end), 1), begin) * SECONDS_IN_DAY;\n        break;\n    }\n  }\n\n  var offsetSeconds = offset * SECONDS_IN_DAY;\n  var totalLength = offsetSeconds + span; // the best way to detect if an event is outside the week-view\n  // is to check if the total span beginning (from startOfWeekDay or event start) exceeds the total days in the view\n\n  var secondsInView = totalDaysInView * SECONDS_IN_DAY;\n\n  if (totalLength > secondsInView) {\n    span = secondsInView - offsetSeconds;\n  }\n\n  span -= getExcludedSeconds(dateAdapter, {\n    startDate: begin,\n    seconds: span,\n    excluded: excluded,\n    precision: precision\n  });\n  return span / SECONDS_IN_DAY;\n}\n\nfunction getWeekViewEventOffset(dateAdapter, _a) {\n  var event = _a.event,\n      startOfWeekDate = _a.startOfWeek,\n      excluded = _a.excluded,\n      precision = _a.precision;\n  var differenceInDays = dateAdapter.differenceInDays,\n      startOfDay = dateAdapter.startOfDay,\n      differenceInSeconds = dateAdapter.differenceInSeconds;\n\n  if (event.start < startOfWeekDate) {\n    return 0;\n  }\n\n  var offset = 0;\n\n  switch (precision) {\n    case 'days':\n      offset = differenceInDays(startOfDay(event.start), startOfWeekDate) * SECONDS_IN_DAY;\n      break;\n\n    case 'minutes':\n      offset = differenceInSeconds(event.start, startOfWeekDate);\n      break;\n  }\n\n  offset -= getExcludedSeconds(dateAdapter, {\n    startDate: startOfWeekDate,\n    seconds: offset,\n    excluded: excluded,\n    precision: precision\n  });\n  return Math.abs(offset / SECONDS_IN_DAY);\n}\n\nfunction isEventIsPeriod(dateAdapter, _a) {\n  var event = _a.event,\n      periodStart = _a.periodStart,\n      periodEnd = _a.periodEnd;\n  var isSameSecond = dateAdapter.isSameSecond;\n  var eventStart = event.start;\n  var eventEnd = event.end || event.start;\n\n  if (eventStart > periodStart && eventStart < periodEnd) {\n    return true;\n  }\n\n  if (eventEnd > periodStart && eventEnd < periodEnd) {\n    return true;\n  }\n\n  if (eventStart < periodStart && eventEnd > periodEnd) {\n    return true;\n  }\n\n  if (isSameSecond(eventStart, periodStart) || isSameSecond(eventStart, periodEnd)) {\n    return true;\n  }\n\n  if (isSameSecond(eventEnd, periodStart) || isSameSecond(eventEnd, periodEnd)) {\n    return true;\n  }\n\n  return false;\n}\n\nexport function getEventsInPeriod(dateAdapter, _a) {\n  var events = _a.events,\n      periodStart = _a.periodStart,\n      periodEnd = _a.periodEnd;\n  return events.filter(function (event) {\n    return isEventIsPeriod(dateAdapter, {\n      event: event,\n      periodStart: periodStart,\n      periodEnd: periodEnd\n    });\n  });\n}\n\nfunction getWeekDay(dateAdapter, _a) {\n  var date = _a.date,\n      _b = _a.weekendDays,\n      weekendDays = _b === void 0 ? DEFAULT_WEEKEND_DAYS : _b;\n  var startOfDay = dateAdapter.startOfDay,\n      isSameDay = dateAdapter.isSameDay,\n      getDay = dateAdapter.getDay;\n  var today = startOfDay(new Date());\n  var day = getDay(date);\n  return {\n    date: date,\n    day: day,\n    isPast: date < today,\n    isToday: isSameDay(date, today),\n    isFuture: date > today,\n    isWeekend: weekendDays.indexOf(day) > -1\n  };\n}\n\nexport function getWeekViewHeader(dateAdapter, _a) {\n  var viewDate = _a.viewDate,\n      weekStartsOn = _a.weekStartsOn,\n      _b = _a.excluded,\n      excluded = _b === void 0 ? [] : _b,\n      weekendDays = _a.weekendDays,\n      _c = _a.viewStart,\n      viewStart = _c === void 0 ? dateAdapter.startOfWeek(viewDate, {\n    weekStartsOn: weekStartsOn\n  }) : _c,\n      _d = _a.viewEnd,\n      viewEnd = _d === void 0 ? dateAdapter.addDays(viewStart, DAYS_IN_WEEK) : _d;\n  var addDays = dateAdapter.addDays,\n      getDay = dateAdapter.getDay;\n  var days = [];\n  var date = viewStart;\n\n  while (date < viewEnd) {\n    if (!excluded.some(function (e) {\n      return getDay(date) === e;\n    })) {\n      days.push(getWeekDay(dateAdapter, {\n        date: date,\n        weekendDays: weekendDays\n      }));\n    }\n\n    date = addDays(date, 1);\n  }\n\n  return days;\n}\nexport function getDifferenceInDaysWithExclusions(dateAdapter, _a) {\n  var date1 = _a.date1,\n      date2 = _a.date2,\n      excluded = _a.excluded;\n  var date = date1;\n  var diff = 0;\n\n  while (date < date2) {\n    if (excluded.indexOf(dateAdapter.getDay(date)) === -1) {\n      diff++;\n    }\n\n    date = dateAdapter.addDays(date, 1);\n  }\n\n  return diff;\n}\nexport function getAllDayWeekEvents(dateAdapter, _a) {\n  var _b = _a.events,\n      events = _b === void 0 ? [] : _b,\n      _c = _a.excluded,\n      excluded = _c === void 0 ? [] : _c,\n      _d = _a.precision,\n      precision = _d === void 0 ? 'days' : _d,\n      _e = _a.absolutePositionedEvents,\n      absolutePositionedEvents = _e === void 0 ? false : _e,\n      viewStart = _a.viewStart,\n      viewEnd = _a.viewEnd;\n  viewStart = dateAdapter.startOfDay(viewStart);\n  viewEnd = dateAdapter.endOfDay(viewEnd);\n  var differenceInSeconds = dateAdapter.differenceInSeconds,\n      differenceInDays = dateAdapter.differenceInDays;\n  var maxRange = getDifferenceInDaysWithExclusions(dateAdapter, {\n    date1: viewStart,\n    date2: viewEnd,\n    excluded: excluded\n  });\n  var totalDaysInView = differenceInDays(viewEnd, viewStart) + 1;\n  var eventsMapped = events.filter(function (event) {\n    return event.allDay;\n  }).map(function (event) {\n    var offset = getWeekViewEventOffset(dateAdapter, {\n      event: event,\n      startOfWeek: viewStart,\n      excluded: excluded,\n      precision: precision\n    });\n    var span = getWeekViewEventSpan(dateAdapter, {\n      event: event,\n      offset: offset,\n      startOfWeekDate: viewStart,\n      excluded: excluded,\n      precision: precision,\n      totalDaysInView: totalDaysInView\n    });\n    return {\n      event: event,\n      offset: offset,\n      span: span\n    };\n  }).filter(function (e) {\n    return e.offset < maxRange;\n  }).filter(function (e) {\n    return e.span > 0;\n  }).map(function (entry) {\n    return {\n      event: entry.event,\n      offset: entry.offset,\n      span: entry.span,\n      startsBeforeWeek: entry.event.start < viewStart,\n      endsAfterWeek: (entry.event.end || entry.event.start) > viewEnd\n    };\n  }).sort(function (itemA, itemB) {\n    var startSecondsDiff = differenceInSeconds(itemA.event.start, itemB.event.start);\n\n    if (startSecondsDiff === 0) {\n      return differenceInSeconds(itemB.event.end || itemB.event.start, itemA.event.end || itemA.event.start);\n    }\n\n    return startSecondsDiff;\n  });\n  var allDayEventRows = [];\n  var allocatedEvents = [];\n  eventsMapped.forEach(function (event, index) {\n    if (allocatedEvents.indexOf(event) === -1) {\n      allocatedEvents.push(event);\n      var rowSpan_1 = event.span + event.offset;\n      var otherRowEvents = eventsMapped.slice(index + 1).filter(function (nextEvent) {\n        if (nextEvent.offset >= rowSpan_1 && rowSpan_1 + nextEvent.span <= totalDaysInView && allocatedEvents.indexOf(nextEvent) === -1) {\n          var nextEventOffset = nextEvent.offset - rowSpan_1;\n\n          if (!absolutePositionedEvents) {\n            nextEvent.offset = nextEventOffset;\n          }\n\n          rowSpan_1 += nextEvent.span + nextEventOffset;\n          allocatedEvents.push(nextEvent);\n          return true;\n        }\n      });\n\n      var weekEvents = __spreadArrays([event], otherRowEvents);\n\n      var id = weekEvents.filter(function (weekEvent) {\n        return weekEvent.event.id;\n      }).map(function (weekEvent) {\n        return weekEvent.event.id;\n      }).join('-');\n      allDayEventRows.push(__assign({\n        row: weekEvents\n      }, id ? {\n        id: id\n      } : {}));\n    }\n  });\n  return allDayEventRows;\n}\n\nfunction getWeekViewHourGrid(dateAdapter, _a) {\n  var events = _a.events,\n      viewDate = _a.viewDate,\n      hourSegments = _a.hourSegments,\n      hourDuration = _a.hourDuration,\n      dayStart = _a.dayStart,\n      dayEnd = _a.dayEnd,\n      weekStartsOn = _a.weekStartsOn,\n      excluded = _a.excluded,\n      weekendDays = _a.weekendDays,\n      segmentHeight = _a.segmentHeight,\n      viewStart = _a.viewStart,\n      viewEnd = _a.viewEnd,\n      minimumEventHeight = _a.minimumEventHeight;\n  var dayViewHourGrid = getDayViewHourGrid(dateAdapter, {\n    viewDate: viewDate,\n    hourSegments: hourSegments,\n    hourDuration: hourDuration,\n    dayStart: dayStart,\n    dayEnd: dayEnd\n  });\n  var weekDays = getWeekViewHeader(dateAdapter, {\n    viewDate: viewDate,\n    weekStartsOn: weekStartsOn,\n    excluded: excluded,\n    weekendDays: weekendDays,\n    viewStart: viewStart,\n    viewEnd: viewEnd\n  });\n  var setHours = dateAdapter.setHours,\n      setMinutes = dateAdapter.setMinutes,\n      getHours = dateAdapter.getHours,\n      getMinutes = dateAdapter.getMinutes;\n  return weekDays.map(function (day) {\n    var dayView = getDayView(dateAdapter, {\n      events: events,\n      viewDate: day.date,\n      hourSegments: hourSegments,\n      dayStart: dayStart,\n      dayEnd: dayEnd,\n      segmentHeight: segmentHeight,\n      eventWidth: 1,\n      hourDuration: hourDuration,\n      minimumEventHeight: minimumEventHeight\n    });\n    var hours = dayViewHourGrid.map(function (hour) {\n      var segments = hour.segments.map(function (segment) {\n        var date = setMinutes(setHours(day.date, getHours(segment.date)), getMinutes(segment.date));\n        return __assign(__assign({}, segment), {\n          date: date\n        });\n      });\n      return __assign(__assign({}, hour), {\n        segments: segments\n      });\n    });\n\n    function getColumnCount(allEvents, prevOverlappingEvents) {\n      var columnCount = Math.max.apply(Math, prevOverlappingEvents.map(function (iEvent) {\n        return iEvent.left + 1;\n      }));\n      var nextOverlappingEvents = allEvents.filter(function (iEvent) {\n        return iEvent.left >= columnCount;\n      }).filter(function (iEvent) {\n        return getOverLappingWeekViewEvents(prevOverlappingEvents, iEvent.top, iEvent.top + iEvent.height).length > 0;\n      });\n\n      if (nextOverlappingEvents.length > 0) {\n        return getColumnCount(allEvents, nextOverlappingEvents);\n      } else {\n        return columnCount;\n      }\n    }\n\n    var mappedEvents = dayView.events.map(function (event) {\n      var columnCount = getColumnCount(dayView.events, getOverLappingWeekViewEvents(dayView.events, event.top, event.top + event.height));\n      var width = 100 / columnCount;\n      return __assign(__assign({}, event), {\n        left: event.left * width,\n        width: width\n      });\n    });\n    return {\n      hours: hours,\n      date: day.date,\n      events: mappedEvents.map(function (event) {\n        var overLappingEvents = getOverLappingWeekViewEvents(mappedEvents.filter(function (otherEvent) {\n          return otherEvent.left > event.left;\n        }), event.top, event.top + event.height);\n\n        if (overLappingEvents.length > 0) {\n          return __assign(__assign({}, event), {\n            width: Math.min.apply(Math, overLappingEvents.map(function (otherEvent) {\n              return otherEvent.left;\n            })) - event.left\n          });\n        }\n\n        return event;\n      })\n    };\n  });\n}\n\nexport function getWeekView(dateAdapter, _a) {\n  var _b = _a.events,\n      events = _b === void 0 ? [] : _b,\n      viewDate = _a.viewDate,\n      weekStartsOn = _a.weekStartsOn,\n      _c = _a.excluded,\n      excluded = _c === void 0 ? [] : _c,\n      _d = _a.precision,\n      precision = _d === void 0 ? 'days' : _d,\n      _e = _a.absolutePositionedEvents,\n      absolutePositionedEvents = _e === void 0 ? false : _e,\n      hourSegments = _a.hourSegments,\n      hourDuration = _a.hourDuration,\n      dayStart = _a.dayStart,\n      dayEnd = _a.dayEnd,\n      weekendDays = _a.weekendDays,\n      segmentHeight = _a.segmentHeight,\n      minimumEventHeight = _a.minimumEventHeight,\n      _f = _a.viewStart,\n      viewStart = _f === void 0 ? dateAdapter.startOfWeek(viewDate, {\n    weekStartsOn: weekStartsOn\n  }) : _f,\n      _g = _a.viewEnd,\n      viewEnd = _g === void 0 ? dateAdapter.endOfWeek(viewDate, {\n    weekStartsOn: weekStartsOn\n  }) : _g;\n\n  if (!events) {\n    events = [];\n  }\n\n  var startOfDay = dateAdapter.startOfDay,\n      endOfDay = dateAdapter.endOfDay;\n  viewStart = startOfDay(viewStart);\n  viewEnd = endOfDay(viewEnd);\n  var eventsInPeriod = getEventsInPeriod(dateAdapter, {\n    events: events,\n    periodStart: viewStart,\n    periodEnd: viewEnd\n  });\n  var header = getWeekViewHeader(dateAdapter, {\n    viewDate: viewDate,\n    weekStartsOn: weekStartsOn,\n    excluded: excluded,\n    weekendDays: weekendDays,\n    viewStart: viewStart,\n    viewEnd: viewEnd\n  });\n  return {\n    allDayEventRows: getAllDayWeekEvents(dateAdapter, {\n      events: eventsInPeriod,\n      excluded: excluded,\n      precision: precision,\n      absolutePositionedEvents: absolutePositionedEvents,\n      viewStart: viewStart,\n      viewEnd: viewEnd\n    }),\n    period: {\n      events: eventsInPeriod,\n      start: header[0].date,\n      end: endOfDay(header[header.length - 1].date)\n    },\n    hourColumns: getWeekViewHourGrid(dateAdapter, {\n      events: events,\n      viewDate: viewDate,\n      hourSegments: hourSegments,\n      hourDuration: hourDuration,\n      dayStart: dayStart,\n      dayEnd: dayEnd,\n      weekStartsOn: weekStartsOn,\n      excluded: excluded,\n      weekendDays: weekendDays,\n      segmentHeight: segmentHeight,\n      viewStart: viewStart,\n      viewEnd: viewEnd,\n      minimumEventHeight: minimumEventHeight\n    })\n  };\n}\nexport function getMonthView(dateAdapter, _a) {\n  var _b = _a.events,\n      events = _b === void 0 ? [] : _b,\n      viewDate = _a.viewDate,\n      weekStartsOn = _a.weekStartsOn,\n      _c = _a.excluded,\n      excluded = _c === void 0 ? [] : _c,\n      _d = _a.viewStart,\n      viewStart = _d === void 0 ? dateAdapter.startOfMonth(viewDate) : _d,\n      _e = _a.viewEnd,\n      viewEnd = _e === void 0 ? dateAdapter.endOfMonth(viewDate) : _e,\n      weekendDays = _a.weekendDays;\n\n  if (!events) {\n    events = [];\n  }\n\n  var startOfWeek = dateAdapter.startOfWeek,\n      endOfWeek = dateAdapter.endOfWeek,\n      differenceInDays = dateAdapter.differenceInDays,\n      startOfDay = dateAdapter.startOfDay,\n      addHours = dateAdapter.addHours,\n      endOfDay = dateAdapter.endOfDay,\n      isSameMonth = dateAdapter.isSameMonth,\n      getDay = dateAdapter.getDay,\n      getMonth = dateAdapter.getMonth;\n  var start = startOfWeek(viewStart, {\n    weekStartsOn: weekStartsOn\n  });\n  var end = endOfWeek(viewEnd, {\n    weekStartsOn: weekStartsOn\n  });\n  var eventsInMonth = getEventsInPeriod(dateAdapter, {\n    events: events,\n    periodStart: start,\n    periodEnd: end\n  });\n  var initialViewDays = [];\n  var previousDate;\n\n  var _loop_2 = function _loop_2(i) {\n    // hacky fix for https://github.com/mattlewis92/angular-calendar/issues/173\n    var date;\n\n    if (previousDate) {\n      date = startOfDay(addHours(previousDate, HOURS_IN_DAY));\n\n      if (previousDate.getTime() === date.getTime()) {\n        // DST change, so need to add 25 hours\n\n        /* istanbul ignore next */\n        date = startOfDay(addHours(previousDate, HOURS_IN_DAY + 1));\n      }\n\n      previousDate = date;\n    } else {\n      date = previousDate = start;\n    }\n\n    if (!excluded.some(function (e) {\n      return getDay(date) === e;\n    })) {\n      var day = getWeekDay(dateAdapter, {\n        date: date,\n        weekendDays: weekendDays\n      });\n      var eventsInPeriod = getEventsInPeriod(dateAdapter, {\n        events: eventsInMonth,\n        periodStart: startOfDay(date),\n        periodEnd: endOfDay(date)\n      });\n      day.inMonth = isSameMonth(date, viewDate);\n      day.events = eventsInPeriod;\n      day.badgeTotal = eventsInPeriod.length;\n      initialViewDays.push(day);\n    }\n  };\n\n  for (var i = 0; i < differenceInDays(end, start) + 1; i++) {\n    _loop_2(i);\n  }\n\n  var days = [];\n  var totalDaysVisibleInWeek = DAYS_IN_WEEK - excluded.length;\n\n  if (totalDaysVisibleInWeek < DAYS_IN_WEEK) {\n    for (var i = 0; i < initialViewDays.length; i += totalDaysVisibleInWeek) {\n      var row = initialViewDays.slice(i, i + totalDaysVisibleInWeek);\n      var isRowInMonth = row.some(function (day) {\n        return viewStart <= day.date && day.date < viewEnd;\n      });\n\n      if (isRowInMonth) {\n        days = __spreadArrays(days, row);\n      }\n    }\n  } else {\n    days = initialViewDays;\n  }\n\n  var rows = Math.floor(days.length / totalDaysVisibleInWeek);\n  var rowOffsets = [];\n\n  for (var i = 0; i < rows; i++) {\n    rowOffsets.push(i * totalDaysVisibleInWeek);\n  }\n\n  return {\n    rowOffsets: rowOffsets,\n    totalDaysVisibleInWeek: totalDaysVisibleInWeek,\n    days: days,\n    period: {\n      start: days[0].date,\n      end: endOfDay(days[days.length - 1].date),\n      events: eventsInMonth\n    }\n  };\n}\n\nfunction getOverLappingWeekViewEvents(events, top, bottom) {\n  return events.filter(function (previousEvent) {\n    var previousEventTop = previousEvent.top;\n    var previousEventBottom = previousEvent.top + previousEvent.height;\n\n    if (top < previousEventBottom && previousEventBottom < bottom) {\n      return true;\n    } else if (top < previousEventTop && previousEventTop < bottom) {\n      return true;\n    } else if (previousEventTop <= top && bottom <= previousEventBottom) {\n      return true;\n    }\n\n    return false;\n  });\n}\n\nfunction getDayView(dateAdapter, _a) {\n  var events = _a.events,\n      viewDate = _a.viewDate,\n      hourSegments = _a.hourSegments,\n      dayStart = _a.dayStart,\n      dayEnd = _a.dayEnd,\n      eventWidth = _a.eventWidth,\n      segmentHeight = _a.segmentHeight,\n      hourDuration = _a.hourDuration,\n      minimumEventHeight = _a.minimumEventHeight;\n  var setMinutes = dateAdapter.setMinutes,\n      setHours = dateAdapter.setHours,\n      startOfDay = dateAdapter.startOfDay,\n      startOfMinute = dateAdapter.startOfMinute,\n      endOfDay = dateAdapter.endOfDay,\n      differenceInMinutes = dateAdapter.differenceInMinutes;\n  var startOfView = setMinutes(setHours(startOfDay(viewDate), sanitiseHours(dayStart.hour)), sanitiseMinutes(dayStart.minute));\n  var endOfView = setMinutes(setHours(startOfMinute(endOfDay(viewDate)), sanitiseHours(dayEnd.hour)), sanitiseMinutes(dayEnd.minute));\n  endOfView.setSeconds(59, 999);\n  var previousDayEvents = [];\n  var eventsInPeriod = getEventsInPeriod(dateAdapter, {\n    events: events.filter(function (event) {\n      return !event.allDay;\n    }),\n    periodStart: startOfView,\n    periodEnd: endOfView\n  });\n  var dayViewEvents = eventsInPeriod.sort(function (eventA, eventB) {\n    return eventA.start.valueOf() - eventB.start.valueOf();\n  }).map(function (event) {\n    var eventStart = event.start;\n    var eventEnd = event.end || eventStart;\n    var startsBeforeDay = eventStart < startOfView;\n    var endsAfterDay = eventEnd > endOfView;\n    var hourHeightModifier = hourSegments * segmentHeight / (hourDuration || MINUTES_IN_HOUR);\n    var top = 0;\n\n    if (eventStart > startOfView) {\n      // adjust the difference in minutes if the user's offset is different between the start of the day and the event (e.g. when going to or from DST)\n      var eventOffset = eventStart.getTimezoneOffset();\n      var startOffset = startOfView.getTimezoneOffset();\n      var diff = startOffset - eventOffset;\n      top += differenceInMinutes(eventStart, startOfView) + diff;\n    }\n\n    top *= hourHeightModifier;\n    var startDate = startsBeforeDay ? startOfView : eventStart;\n    var endDate = endsAfterDay ? endOfView : eventEnd;\n    var timezoneOffset = startDate.getTimezoneOffset() - endDate.getTimezoneOffset();\n    var height = differenceInMinutes(endDate, startDate) + timezoneOffset;\n\n    if (!event.end) {\n      height = segmentHeight;\n    } else {\n      height *= hourHeightModifier;\n    }\n\n    if (minimumEventHeight && height < minimumEventHeight) {\n      height = minimumEventHeight;\n    }\n\n    var bottom = top + height;\n    var overlappingPreviousEvents = getOverLappingWeekViewEvents(previousDayEvents, top, bottom);\n    var left = 0;\n\n    while (overlappingPreviousEvents.some(function (previousEvent) {\n      return previousEvent.left === left;\n    })) {\n      left += eventWidth;\n    }\n\n    var dayEvent = {\n      event: event,\n      height: height,\n      width: eventWidth,\n      top: top,\n      left: left,\n      startsBeforeDay: startsBeforeDay,\n      endsAfterDay: endsAfterDay\n    };\n    previousDayEvents.push(dayEvent);\n    return dayEvent;\n  });\n  var width = Math.max.apply(Math, dayViewEvents.map(function (event) {\n    return event.left + event.width;\n  }));\n  var allDayEvents = getEventsInPeriod(dateAdapter, {\n    events: events.filter(function (event) {\n      return event.allDay;\n    }),\n    periodStart: startOfDay(startOfView),\n    periodEnd: endOfDay(endOfView)\n  });\n  return {\n    events: dayViewEvents,\n    width: width,\n    allDayEvents: allDayEvents,\n    period: {\n      events: eventsInPeriod,\n      start: startOfView,\n      end: endOfView\n    }\n  };\n}\n\nfunction sanitiseHours(hours) {\n  return Math.max(Math.min(23, hours), 0);\n}\n\nfunction sanitiseMinutes(minutes) {\n  return Math.max(Math.min(59, minutes), 0);\n}\n\nfunction getDayViewHourGrid(dateAdapter, _a) {\n  var viewDate = _a.viewDate,\n      hourSegments = _a.hourSegments,\n      hourDuration = _a.hourDuration,\n      dayStart = _a.dayStart,\n      dayEnd = _a.dayEnd;\n  var setMinutes = dateAdapter.setMinutes,\n      setHours = dateAdapter.setHours,\n      startOfDay = dateAdapter.startOfDay,\n      startOfMinute = dateAdapter.startOfMinute,\n      endOfDay = dateAdapter.endOfDay,\n      addMinutes = dateAdapter.addMinutes,\n      addHours = dateAdapter.addHours,\n      addDays = dateAdapter.addDays;\n  var hours = [];\n  var startOfView = setMinutes(setHours(startOfDay(viewDate), sanitiseHours(dayStart.hour)), sanitiseMinutes(dayStart.minute));\n  var endOfView = setMinutes(setHours(startOfMinute(endOfDay(viewDate)), sanitiseHours(dayEnd.hour)), sanitiseMinutes(dayEnd.minute));\n  var segmentDuration = (hourDuration || MINUTES_IN_HOUR) / hourSegments;\n  var startOfViewDay = startOfDay(viewDate);\n  var endOfViewDay = endOfDay(viewDate);\n\n  var dateAdjustment = function dateAdjustment(d) {\n    return d;\n  }; // this means that we change from or to DST on this day and that's going to cause problems so we bump the date\n\n\n  if (startOfViewDay.getTimezoneOffset() !== endOfViewDay.getTimezoneOffset()) {\n    startOfViewDay = addDays(startOfViewDay, 1);\n    startOfView = addDays(startOfView, 1);\n    endOfView = addDays(endOfView, 1);\n\n    dateAdjustment = function dateAdjustment(d) {\n      return addDays(d, -1);\n    };\n  }\n\n  var dayDuration = hourDuration ? HOURS_IN_DAY * 60 / hourDuration : MINUTES_IN_HOUR;\n\n  for (var i = 0; i < dayDuration; i++) {\n    var segments = [];\n\n    for (var j = 0; j < hourSegments; j++) {\n      var date = addMinutes(addMinutes(startOfView, i * (hourDuration || MINUTES_IN_HOUR)), j * segmentDuration);\n\n      if (date >= startOfView && date < endOfView) {\n        segments.push({\n          date: dateAdjustment(date),\n          displayDate: date,\n          isStart: j === 0\n        });\n      }\n    }\n\n    if (segments.length > 0) {\n      hours.push({\n        segments: segments\n      });\n    }\n  }\n\n  return hours;\n}\n\nexport var EventValidationErrorMessage;\n\n(function (EventValidationErrorMessage) {\n  EventValidationErrorMessage[\"NotArray\"] = \"Events must be an array\";\n  EventValidationErrorMessage[\"StartPropertyMissing\"] = \"Event is missing the `start` property\";\n  EventValidationErrorMessage[\"StartPropertyNotDate\"] = \"Event `start` property should be a javascript date object. Do `new Date(event.start)` to fix it.\";\n  EventValidationErrorMessage[\"EndPropertyNotDate\"] = \"Event `end` property should be a javascript date object. Do `new Date(event.end)` to fix it.\";\n  EventValidationErrorMessage[\"EndsBeforeStart\"] = \"Event `start` property occurs after the `end`\";\n})(EventValidationErrorMessage || (EventValidationErrorMessage = {}));\n\nexport function validateEvents(events, log) {\n  var isValid = true;\n\n  function isError(msg, event) {\n    log(msg, event);\n    isValid = false;\n  }\n\n  if (!Array.isArray(events)) {\n    log(EventValidationErrorMessage.NotArray, events);\n    return false;\n  }\n\n  events.forEach(function (event) {\n    if (!event.start) {\n      isError(EventValidationErrorMessage.StartPropertyMissing, event);\n    } else if (!(event.start instanceof Date)) {\n      isError(EventValidationErrorMessage.StartPropertyNotDate, event);\n    }\n\n    if (event.end) {\n      if (!(event.end instanceof Date)) {\n        isError(EventValidationErrorMessage.EndPropertyNotDate, event);\n      }\n\n      if (event.start > event.end) {\n        isError(EventValidationErrorMessage.EndsBeforeStart, event);\n      }\n    }\n  });\n  return isValid;\n} //# sourceMappingURL=calendar-utils.js.map","map":{"version":3,"sources":["E:/_Projet/Cnss/FISC_DECLARATION_APP_Client/node_modules/calendar-utils/calendar-utils.js"],"names":["__assign","Object","assign","t","s","i","n","arguments","length","p","prototype","hasOwnProperty","call","apply","__spreadArrays","il","r","Array","k","a","j","jl","DAYS_OF_WEEK","DEFAULT_WEEKEND_DAYS","SUNDAY","SATURDAY","DAYS_IN_WEEK","HOURS_IN_DAY","MINUTES_IN_HOUR","SECONDS_IN_DAY","getExcludedSeconds","dateAdapter","_a","startDate","seconds","excluded","precision","addSeconds","getDay","addDays","endDate","dayStart","dayEnd","result","current","_loop_1","day","some","excludedDay","calculateExcludedSeconds","differenceInSeconds","endOfDay","startOfDay","getWeekViewEventSpan","event","offset","startOfWeekDate","totalDaysInView","max","differenceInDays","span","begin","start","end","offsetSeconds","totalLength","secondsInView","getWeekViewEventOffset","startOfWeek","Math","abs","isEventIsPeriod","periodStart","periodEnd","isSameSecond","eventStart","eventEnd","getEventsInPeriod","events","filter","getWeekDay","date","_b","weekendDays","isSameDay","today","Date","isPast","isToday","isFuture","isWeekend","indexOf","getWeekViewHeader","viewDate","weekStartsOn","_c","viewStart","_d","viewEnd","days","e","push","getDifferenceInDaysWithExclusions","date1","date2","diff","getAllDayWeekEvents","_e","absolutePositionedEvents","maxRange","eventsMapped","allDay","map","entry","startsBeforeWeek","endsAfterWeek","sort","itemA","itemB","startSecondsDiff","allDayEventRows","allocatedEvents","forEach","index","rowSpan_1","otherRowEvents","slice","nextEvent","nextEventOffset","weekEvents","id","weekEvent","join","row","getWeekViewHourGrid","hourSegments","hourDuration","segmentHeight","minimumEventHeight","dayViewHourGrid","getDayViewHourGrid","weekDays","setHours","setMinutes","getHours","getMinutes","dayView","getDayView","eventWidth","hours","hour","segments","segment","getColumnCount","allEvents","prevOverlappingEvents","columnCount","iEvent","left","nextOverlappingEvents","getOverLappingWeekViewEvents","top","height","mappedEvents","width","overLappingEvents","otherEvent","min","getWeekView","_f","_g","endOfWeek","eventsInPeriod","header","period","hourColumns","getMonthView","startOfMonth","endOfMonth","addHours","isSameMonth","getMonth","eventsInMonth","initialViewDays","previousDate","_loop_2","getTime","inMonth","badgeTotal","totalDaysVisibleInWeek","isRowInMonth","rows","floor","rowOffsets","bottom","previousEvent","previousEventTop","previousEventBottom","startOfMinute","differenceInMinutes","startOfView","sanitiseHours","sanitiseMinutes","minute","endOfView","setSeconds","previousDayEvents","dayViewEvents","eventA","eventB","valueOf","startsBeforeDay","endsAfterDay","hourHeightModifier","eventOffset","getTimezoneOffset","startOffset","timezoneOffset","overlappingPreviousEvents","dayEvent","allDayEvents","minutes","addMinutes","segmentDuration","startOfViewDay","endOfViewDay","dateAdjustment","d","dayDuration","displayDate","isStart","EventValidationErrorMessage","validateEvents","log","isValid","isError","msg","isArray","NotArray","StartPropertyMissing","StartPropertyNotDate","EndPropertyNotDate","EndsBeforeStart"],"mappings":"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","sourcesContent":["var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __spreadArrays = (this && this.__spreadArrays) || function () {\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n            r[k] = a[j];\n    return r;\n};\nexport var DAYS_OF_WEEK;\n(function (DAYS_OF_WEEK) {\n    DAYS_OF_WEEK[DAYS_OF_WEEK[\"SUNDAY\"] = 0] = \"SUNDAY\";\n    DAYS_OF_WEEK[DAYS_OF_WEEK[\"MONDAY\"] = 1] = \"MONDAY\";\n    DAYS_OF_WEEK[DAYS_OF_WEEK[\"TUESDAY\"] = 2] = \"TUESDAY\";\n    DAYS_OF_WEEK[DAYS_OF_WEEK[\"WEDNESDAY\"] = 3] = \"WEDNESDAY\";\n    DAYS_OF_WEEK[DAYS_OF_WEEK[\"THURSDAY\"] = 4] = \"THURSDAY\";\n    DAYS_OF_WEEK[DAYS_OF_WEEK[\"FRIDAY\"] = 5] = \"FRIDAY\";\n    DAYS_OF_WEEK[DAYS_OF_WEEK[\"SATURDAY\"] = 6] = \"SATURDAY\";\n})(DAYS_OF_WEEK || (DAYS_OF_WEEK = {}));\nvar DEFAULT_WEEKEND_DAYS = [\n    DAYS_OF_WEEK.SUNDAY,\n    DAYS_OF_WEEK.SATURDAY,\n];\nvar DAYS_IN_WEEK = 7;\nvar HOURS_IN_DAY = 24;\nvar MINUTES_IN_HOUR = 60;\nexport var SECONDS_IN_DAY = 60 * 60 * 24;\nfunction getExcludedSeconds(dateAdapter, _a) {\n    var startDate = _a.startDate, seconds = _a.seconds, excluded = _a.excluded, precision = _a.precision;\n    if (excluded.length < 1) {\n        return 0;\n    }\n    var addSeconds = dateAdapter.addSeconds, getDay = dateAdapter.getDay, addDays = dateAdapter.addDays;\n    var endDate = addSeconds(startDate, seconds - 1);\n    var dayStart = getDay(startDate);\n    var dayEnd = getDay(endDate);\n    var result = 0; // Calculated in seconds\n    var current = startDate;\n    var _loop_1 = function () {\n        var day = getDay(current);\n        if (excluded.some(function (excludedDay) { return excludedDay === day; })) {\n            result += calculateExcludedSeconds(dateAdapter, {\n                dayStart: dayStart,\n                dayEnd: dayEnd,\n                day: day,\n                precision: precision,\n                startDate: startDate,\n                endDate: endDate,\n            });\n        }\n        current = addDays(current, 1);\n    };\n    while (current < endDate) {\n        _loop_1();\n    }\n    return result;\n}\nfunction calculateExcludedSeconds(dateAdapter, _a) {\n    var precision = _a.precision, day = _a.day, dayStart = _a.dayStart, dayEnd = _a.dayEnd, startDate = _a.startDate, endDate = _a.endDate;\n    var differenceInSeconds = dateAdapter.differenceInSeconds, endOfDay = dateAdapter.endOfDay, startOfDay = dateAdapter.startOfDay;\n    if (precision === 'minutes') {\n        if (day === dayStart) {\n            return differenceInSeconds(endOfDay(startDate), startDate) + 1;\n        }\n        else if (day === dayEnd) {\n            return differenceInSeconds(endDate, startOfDay(endDate)) + 1;\n        }\n    }\n    return SECONDS_IN_DAY;\n}\nfunction getWeekViewEventSpan(dateAdapter, _a) {\n    var event = _a.event, offset = _a.offset, startOfWeekDate = _a.startOfWeekDate, excluded = _a.excluded, precision = _a.precision, totalDaysInView = _a.totalDaysInView;\n    var max = dateAdapter.max, differenceInSeconds = dateAdapter.differenceInSeconds, addDays = dateAdapter.addDays, endOfDay = dateAdapter.endOfDay, differenceInDays = dateAdapter.differenceInDays;\n    var span = SECONDS_IN_DAY;\n    var begin = max([event.start, startOfWeekDate]);\n    if (event.end) {\n        switch (precision) {\n            case 'minutes':\n                span = differenceInSeconds(event.end, begin);\n                break;\n            default:\n                span =\n                    differenceInDays(addDays(endOfDay(event.end), 1), begin) *\n                        SECONDS_IN_DAY;\n                break;\n        }\n    }\n    var offsetSeconds = offset * SECONDS_IN_DAY;\n    var totalLength = offsetSeconds + span;\n    // the best way to detect if an event is outside the week-view\n    // is to check if the total span beginning (from startOfWeekDay or event start) exceeds the total days in the view\n    var secondsInView = totalDaysInView * SECONDS_IN_DAY;\n    if (totalLength > secondsInView) {\n        span = secondsInView - offsetSeconds;\n    }\n    span -= getExcludedSeconds(dateAdapter, {\n        startDate: begin,\n        seconds: span,\n        excluded: excluded,\n        precision: precision,\n    });\n    return span / SECONDS_IN_DAY;\n}\nfunction getWeekViewEventOffset(dateAdapter, _a) {\n    var event = _a.event, startOfWeekDate = _a.startOfWeek, excluded = _a.excluded, precision = _a.precision;\n    var differenceInDays = dateAdapter.differenceInDays, startOfDay = dateAdapter.startOfDay, differenceInSeconds = dateAdapter.differenceInSeconds;\n    if (event.start < startOfWeekDate) {\n        return 0;\n    }\n    var offset = 0;\n    switch (precision) {\n        case 'days':\n            offset =\n                differenceInDays(startOfDay(event.start), startOfWeekDate) *\n                    SECONDS_IN_DAY;\n            break;\n        case 'minutes':\n            offset = differenceInSeconds(event.start, startOfWeekDate);\n            break;\n    }\n    offset -= getExcludedSeconds(dateAdapter, {\n        startDate: startOfWeekDate,\n        seconds: offset,\n        excluded: excluded,\n        precision: precision,\n    });\n    return Math.abs(offset / SECONDS_IN_DAY);\n}\nfunction isEventIsPeriod(dateAdapter, _a) {\n    var event = _a.event, periodStart = _a.periodStart, periodEnd = _a.periodEnd;\n    var isSameSecond = dateAdapter.isSameSecond;\n    var eventStart = event.start;\n    var eventEnd = event.end || event.start;\n    if (eventStart > periodStart && eventStart < periodEnd) {\n        return true;\n    }\n    if (eventEnd > periodStart && eventEnd < periodEnd) {\n        return true;\n    }\n    if (eventStart < periodStart && eventEnd > periodEnd) {\n        return true;\n    }\n    if (isSameSecond(eventStart, periodStart) ||\n        isSameSecond(eventStart, periodEnd)) {\n        return true;\n    }\n    if (isSameSecond(eventEnd, periodStart) ||\n        isSameSecond(eventEnd, periodEnd)) {\n        return true;\n    }\n    return false;\n}\nexport function getEventsInPeriod(dateAdapter, _a) {\n    var events = _a.events, periodStart = _a.periodStart, periodEnd = _a.periodEnd;\n    return events.filter(function (event) {\n        return isEventIsPeriod(dateAdapter, { event: event, periodStart: periodStart, periodEnd: periodEnd });\n    });\n}\nfunction getWeekDay(dateAdapter, _a) {\n    var date = _a.date, _b = _a.weekendDays, weekendDays = _b === void 0 ? DEFAULT_WEEKEND_DAYS : _b;\n    var startOfDay = dateAdapter.startOfDay, isSameDay = dateAdapter.isSameDay, getDay = dateAdapter.getDay;\n    var today = startOfDay(new Date());\n    var day = getDay(date);\n    return {\n        date: date,\n        day: day,\n        isPast: date < today,\n        isToday: isSameDay(date, today),\n        isFuture: date > today,\n        isWeekend: weekendDays.indexOf(day) > -1,\n    };\n}\nexport function getWeekViewHeader(dateAdapter, _a) {\n    var viewDate = _a.viewDate, weekStartsOn = _a.weekStartsOn, _b = _a.excluded, excluded = _b === void 0 ? [] : _b, weekendDays = _a.weekendDays, _c = _a.viewStart, viewStart = _c === void 0 ? dateAdapter.startOfWeek(viewDate, { weekStartsOn: weekStartsOn }) : _c, _d = _a.viewEnd, viewEnd = _d === void 0 ? dateAdapter.addDays(viewStart, DAYS_IN_WEEK) : _d;\n    var addDays = dateAdapter.addDays, getDay = dateAdapter.getDay;\n    var days = [];\n    var date = viewStart;\n    while (date < viewEnd) {\n        if (!excluded.some(function (e) { return getDay(date) === e; })) {\n            days.push(getWeekDay(dateAdapter, { date: date, weekendDays: weekendDays }));\n        }\n        date = addDays(date, 1);\n    }\n    return days;\n}\nexport function getDifferenceInDaysWithExclusions(dateAdapter, _a) {\n    var date1 = _a.date1, date2 = _a.date2, excluded = _a.excluded;\n    var date = date1;\n    var diff = 0;\n    while (date < date2) {\n        if (excluded.indexOf(dateAdapter.getDay(date)) === -1) {\n            diff++;\n        }\n        date = dateAdapter.addDays(date, 1);\n    }\n    return diff;\n}\nexport function getAllDayWeekEvents(dateAdapter, _a) {\n    var _b = _a.events, events = _b === void 0 ? [] : _b, _c = _a.excluded, excluded = _c === void 0 ? [] : _c, _d = _a.precision, precision = _d === void 0 ? 'days' : _d, _e = _a.absolutePositionedEvents, absolutePositionedEvents = _e === void 0 ? false : _e, viewStart = _a.viewStart, viewEnd = _a.viewEnd;\n    viewStart = dateAdapter.startOfDay(viewStart);\n    viewEnd = dateAdapter.endOfDay(viewEnd);\n    var differenceInSeconds = dateAdapter.differenceInSeconds, differenceInDays = dateAdapter.differenceInDays;\n    var maxRange = getDifferenceInDaysWithExclusions(dateAdapter, {\n        date1: viewStart,\n        date2: viewEnd,\n        excluded: excluded,\n    });\n    var totalDaysInView = differenceInDays(viewEnd, viewStart) + 1;\n    var eventsMapped = events\n        .filter(function (event) { return event.allDay; })\n        .map(function (event) {\n        var offset = getWeekViewEventOffset(dateAdapter, {\n            event: event,\n            startOfWeek: viewStart,\n            excluded: excluded,\n            precision: precision,\n        });\n        var span = getWeekViewEventSpan(dateAdapter, {\n            event: event,\n            offset: offset,\n            startOfWeekDate: viewStart,\n            excluded: excluded,\n            precision: precision,\n            totalDaysInView: totalDaysInView,\n        });\n        return { event: event, offset: offset, span: span };\n    })\n        .filter(function (e) { return e.offset < maxRange; })\n        .filter(function (e) { return e.span > 0; })\n        .map(function (entry) { return ({\n        event: entry.event,\n        offset: entry.offset,\n        span: entry.span,\n        startsBeforeWeek: entry.event.start < viewStart,\n        endsAfterWeek: (entry.event.end || entry.event.start) > viewEnd,\n    }); })\n        .sort(function (itemA, itemB) {\n        var startSecondsDiff = differenceInSeconds(itemA.event.start, itemB.event.start);\n        if (startSecondsDiff === 0) {\n            return differenceInSeconds(itemB.event.end || itemB.event.start, itemA.event.end || itemA.event.start);\n        }\n        return startSecondsDiff;\n    });\n    var allDayEventRows = [];\n    var allocatedEvents = [];\n    eventsMapped.forEach(function (event, index) {\n        if (allocatedEvents.indexOf(event) === -1) {\n            allocatedEvents.push(event);\n            var rowSpan_1 = event.span + event.offset;\n            var otherRowEvents = eventsMapped\n                .slice(index + 1)\n                .filter(function (nextEvent) {\n                if (nextEvent.offset >= rowSpan_1 &&\n                    rowSpan_1 + nextEvent.span <= totalDaysInView &&\n                    allocatedEvents.indexOf(nextEvent) === -1) {\n                    var nextEventOffset = nextEvent.offset - rowSpan_1;\n                    if (!absolutePositionedEvents) {\n                        nextEvent.offset = nextEventOffset;\n                    }\n                    rowSpan_1 += nextEvent.span + nextEventOffset;\n                    allocatedEvents.push(nextEvent);\n                    return true;\n                }\n            });\n            var weekEvents = __spreadArrays([event], otherRowEvents);\n            var id = weekEvents\n                .filter(function (weekEvent) { return weekEvent.event.id; })\n                .map(function (weekEvent) { return weekEvent.event.id; })\n                .join('-');\n            allDayEventRows.push(__assign({ row: weekEvents }, (id ? { id: id } : {})));\n        }\n    });\n    return allDayEventRows;\n}\nfunction getWeekViewHourGrid(dateAdapter, _a) {\n    var events = _a.events, viewDate = _a.viewDate, hourSegments = _a.hourSegments, hourDuration = _a.hourDuration, dayStart = _a.dayStart, dayEnd = _a.dayEnd, weekStartsOn = _a.weekStartsOn, excluded = _a.excluded, weekendDays = _a.weekendDays, segmentHeight = _a.segmentHeight, viewStart = _a.viewStart, viewEnd = _a.viewEnd, minimumEventHeight = _a.minimumEventHeight;\n    var dayViewHourGrid = getDayViewHourGrid(dateAdapter, {\n        viewDate: viewDate,\n        hourSegments: hourSegments,\n        hourDuration: hourDuration,\n        dayStart: dayStart,\n        dayEnd: dayEnd,\n    });\n    var weekDays = getWeekViewHeader(dateAdapter, {\n        viewDate: viewDate,\n        weekStartsOn: weekStartsOn,\n        excluded: excluded,\n        weekendDays: weekendDays,\n        viewStart: viewStart,\n        viewEnd: viewEnd,\n    });\n    var setHours = dateAdapter.setHours, setMinutes = dateAdapter.setMinutes, getHours = dateAdapter.getHours, getMinutes = dateAdapter.getMinutes;\n    return weekDays.map(function (day) {\n        var dayView = getDayView(dateAdapter, {\n            events: events,\n            viewDate: day.date,\n            hourSegments: hourSegments,\n            dayStart: dayStart,\n            dayEnd: dayEnd,\n            segmentHeight: segmentHeight,\n            eventWidth: 1,\n            hourDuration: hourDuration,\n            minimumEventHeight: minimumEventHeight,\n        });\n        var hours = dayViewHourGrid.map(function (hour) {\n            var segments = hour.segments.map(function (segment) {\n                var date = setMinutes(setHours(day.date, getHours(segment.date)), getMinutes(segment.date));\n                return __assign(__assign({}, segment), { date: date });\n            });\n            return __assign(__assign({}, hour), { segments: segments });\n        });\n        function getColumnCount(allEvents, prevOverlappingEvents) {\n            var columnCount = Math.max.apply(Math, prevOverlappingEvents.map(function (iEvent) { return iEvent.left + 1; }));\n            var nextOverlappingEvents = allEvents\n                .filter(function (iEvent) { return iEvent.left >= columnCount; })\n                .filter(function (iEvent) {\n                return (getOverLappingWeekViewEvents(prevOverlappingEvents, iEvent.top, iEvent.top + iEvent.height).length > 0);\n            });\n            if (nextOverlappingEvents.length > 0) {\n                return getColumnCount(allEvents, nextOverlappingEvents);\n            }\n            else {\n                return columnCount;\n            }\n        }\n        var mappedEvents = dayView.events.map(function (event) {\n            var columnCount = getColumnCount(dayView.events, getOverLappingWeekViewEvents(dayView.events, event.top, event.top + event.height));\n            var width = 100 / columnCount;\n            return __assign(__assign({}, event), { left: event.left * width, width: width });\n        });\n        return {\n            hours: hours,\n            date: day.date,\n            events: mappedEvents.map(function (event) {\n                var overLappingEvents = getOverLappingWeekViewEvents(mappedEvents.filter(function (otherEvent) { return otherEvent.left > event.left; }), event.top, event.top + event.height);\n                if (overLappingEvents.length > 0) {\n                    return __assign(__assign({}, event), { width: Math.min.apply(Math, overLappingEvents.map(function (otherEvent) { return otherEvent.left; })) - event.left });\n                }\n                return event;\n            }),\n        };\n    });\n}\nexport function getWeekView(dateAdapter, _a) {\n    var _b = _a.events, events = _b === void 0 ? [] : _b, viewDate = _a.viewDate, weekStartsOn = _a.weekStartsOn, _c = _a.excluded, excluded = _c === void 0 ? [] : _c, _d = _a.precision, precision = _d === void 0 ? 'days' : _d, _e = _a.absolutePositionedEvents, absolutePositionedEvents = _e === void 0 ? false : _e, hourSegments = _a.hourSegments, hourDuration = _a.hourDuration, dayStart = _a.dayStart, dayEnd = _a.dayEnd, weekendDays = _a.weekendDays, segmentHeight = _a.segmentHeight, minimumEventHeight = _a.minimumEventHeight, _f = _a.viewStart, viewStart = _f === void 0 ? dateAdapter.startOfWeek(viewDate, { weekStartsOn: weekStartsOn }) : _f, _g = _a.viewEnd, viewEnd = _g === void 0 ? dateAdapter.endOfWeek(viewDate, { weekStartsOn: weekStartsOn }) : _g;\n    if (!events) {\n        events = [];\n    }\n    var startOfDay = dateAdapter.startOfDay, endOfDay = dateAdapter.endOfDay;\n    viewStart = startOfDay(viewStart);\n    viewEnd = endOfDay(viewEnd);\n    var eventsInPeriod = getEventsInPeriod(dateAdapter, {\n        events: events,\n        periodStart: viewStart,\n        periodEnd: viewEnd,\n    });\n    var header = getWeekViewHeader(dateAdapter, {\n        viewDate: viewDate,\n        weekStartsOn: weekStartsOn,\n        excluded: excluded,\n        weekendDays: weekendDays,\n        viewStart: viewStart,\n        viewEnd: viewEnd,\n    });\n    return {\n        allDayEventRows: getAllDayWeekEvents(dateAdapter, {\n            events: eventsInPeriod,\n            excluded: excluded,\n            precision: precision,\n            absolutePositionedEvents: absolutePositionedEvents,\n            viewStart: viewStart,\n            viewEnd: viewEnd,\n        }),\n        period: {\n            events: eventsInPeriod,\n            start: header[0].date,\n            end: endOfDay(header[header.length - 1].date),\n        },\n        hourColumns: getWeekViewHourGrid(dateAdapter, {\n            events: events,\n            viewDate: viewDate,\n            hourSegments: hourSegments,\n            hourDuration: hourDuration,\n            dayStart: dayStart,\n            dayEnd: dayEnd,\n            weekStartsOn: weekStartsOn,\n            excluded: excluded,\n            weekendDays: weekendDays,\n            segmentHeight: segmentHeight,\n            viewStart: viewStart,\n            viewEnd: viewEnd,\n            minimumEventHeight: minimumEventHeight,\n        }),\n    };\n}\nexport function getMonthView(dateAdapter, _a) {\n    var _b = _a.events, events = _b === void 0 ? [] : _b, viewDate = _a.viewDate, weekStartsOn = _a.weekStartsOn, _c = _a.excluded, excluded = _c === void 0 ? [] : _c, _d = _a.viewStart, viewStart = _d === void 0 ? dateAdapter.startOfMonth(viewDate) : _d, _e = _a.viewEnd, viewEnd = _e === void 0 ? dateAdapter.endOfMonth(viewDate) : _e, weekendDays = _a.weekendDays;\n    if (!events) {\n        events = [];\n    }\n    var startOfWeek = dateAdapter.startOfWeek, endOfWeek = dateAdapter.endOfWeek, differenceInDays = dateAdapter.differenceInDays, startOfDay = dateAdapter.startOfDay, addHours = dateAdapter.addHours, endOfDay = dateAdapter.endOfDay, isSameMonth = dateAdapter.isSameMonth, getDay = dateAdapter.getDay, getMonth = dateAdapter.getMonth;\n    var start = startOfWeek(viewStart, { weekStartsOn: weekStartsOn });\n    var end = endOfWeek(viewEnd, { weekStartsOn: weekStartsOn });\n    var eventsInMonth = getEventsInPeriod(dateAdapter, {\n        events: events,\n        periodStart: start,\n        periodEnd: end,\n    });\n    var initialViewDays = [];\n    var previousDate;\n    var _loop_2 = function (i) {\n        // hacky fix for https://github.com/mattlewis92/angular-calendar/issues/173\n        var date;\n        if (previousDate) {\n            date = startOfDay(addHours(previousDate, HOURS_IN_DAY));\n            if (previousDate.getTime() === date.getTime()) {\n                // DST change, so need to add 25 hours\n                /* istanbul ignore next */\n                date = startOfDay(addHours(previousDate, HOURS_IN_DAY + 1));\n            }\n            previousDate = date;\n        }\n        else {\n            date = previousDate = start;\n        }\n        if (!excluded.some(function (e) { return getDay(date) === e; })) {\n            var day = getWeekDay(dateAdapter, {\n                date: date,\n                weekendDays: weekendDays,\n            });\n            var eventsInPeriod = getEventsInPeriod(dateAdapter, {\n                events: eventsInMonth,\n                periodStart: startOfDay(date),\n                periodEnd: endOfDay(date),\n            });\n            day.inMonth = isSameMonth(date, viewDate);\n            day.events = eventsInPeriod;\n            day.badgeTotal = eventsInPeriod.length;\n            initialViewDays.push(day);\n        }\n    };\n    for (var i = 0; i < differenceInDays(end, start) + 1; i++) {\n        _loop_2(i);\n    }\n    var days = [];\n    var totalDaysVisibleInWeek = DAYS_IN_WEEK - excluded.length;\n    if (totalDaysVisibleInWeek < DAYS_IN_WEEK) {\n        for (var i = 0; i < initialViewDays.length; i += totalDaysVisibleInWeek) {\n            var row = initialViewDays.slice(i, i + totalDaysVisibleInWeek);\n            var isRowInMonth = row.some(function (day) { return viewStart <= day.date && day.date < viewEnd; });\n            if (isRowInMonth) {\n                days = __spreadArrays(days, row);\n            }\n        }\n    }\n    else {\n        days = initialViewDays;\n    }\n    var rows = Math.floor(days.length / totalDaysVisibleInWeek);\n    var rowOffsets = [];\n    for (var i = 0; i < rows; i++) {\n        rowOffsets.push(i * totalDaysVisibleInWeek);\n    }\n    return {\n        rowOffsets: rowOffsets,\n        totalDaysVisibleInWeek: totalDaysVisibleInWeek,\n        days: days,\n        period: {\n            start: days[0].date,\n            end: endOfDay(days[days.length - 1].date),\n            events: eventsInMonth,\n        },\n    };\n}\nfunction getOverLappingWeekViewEvents(events, top, bottom) {\n    return events.filter(function (previousEvent) {\n        var previousEventTop = previousEvent.top;\n        var previousEventBottom = previousEvent.top + previousEvent.height;\n        if (top < previousEventBottom && previousEventBottom < bottom) {\n            return true;\n        }\n        else if (top < previousEventTop && previousEventTop < bottom) {\n            return true;\n        }\n        else if (previousEventTop <= top && bottom <= previousEventBottom) {\n            return true;\n        }\n        return false;\n    });\n}\nfunction getDayView(dateAdapter, _a) {\n    var events = _a.events, viewDate = _a.viewDate, hourSegments = _a.hourSegments, dayStart = _a.dayStart, dayEnd = _a.dayEnd, eventWidth = _a.eventWidth, segmentHeight = _a.segmentHeight, hourDuration = _a.hourDuration, minimumEventHeight = _a.minimumEventHeight;\n    var setMinutes = dateAdapter.setMinutes, setHours = dateAdapter.setHours, startOfDay = dateAdapter.startOfDay, startOfMinute = dateAdapter.startOfMinute, endOfDay = dateAdapter.endOfDay, differenceInMinutes = dateAdapter.differenceInMinutes;\n    var startOfView = setMinutes(setHours(startOfDay(viewDate), sanitiseHours(dayStart.hour)), sanitiseMinutes(dayStart.minute));\n    var endOfView = setMinutes(setHours(startOfMinute(endOfDay(viewDate)), sanitiseHours(dayEnd.hour)), sanitiseMinutes(dayEnd.minute));\n    endOfView.setSeconds(59, 999);\n    var previousDayEvents = [];\n    var eventsInPeriod = getEventsInPeriod(dateAdapter, {\n        events: events.filter(function (event) { return !event.allDay; }),\n        periodStart: startOfView,\n        periodEnd: endOfView,\n    });\n    var dayViewEvents = eventsInPeriod\n        .sort(function (eventA, eventB) {\n        return eventA.start.valueOf() - eventB.start.valueOf();\n    })\n        .map(function (event) {\n        var eventStart = event.start;\n        var eventEnd = event.end || eventStart;\n        var startsBeforeDay = eventStart < startOfView;\n        var endsAfterDay = eventEnd > endOfView;\n        var hourHeightModifier = (hourSegments * segmentHeight) / (hourDuration || MINUTES_IN_HOUR);\n        var top = 0;\n        if (eventStart > startOfView) {\n            // adjust the difference in minutes if the user's offset is different between the start of the day and the event (e.g. when going to or from DST)\n            var eventOffset = eventStart.getTimezoneOffset();\n            var startOffset = startOfView.getTimezoneOffset();\n            var diff = startOffset - eventOffset;\n            top += differenceInMinutes(eventStart, startOfView) + diff;\n        }\n        top *= hourHeightModifier;\n        var startDate = startsBeforeDay ? startOfView : eventStart;\n        var endDate = endsAfterDay ? endOfView : eventEnd;\n        var timezoneOffset = startDate.getTimezoneOffset() - endDate.getTimezoneOffset();\n        var height = differenceInMinutes(endDate, startDate) + timezoneOffset;\n        if (!event.end) {\n            height = segmentHeight;\n        }\n        else {\n            height *= hourHeightModifier;\n        }\n        if (minimumEventHeight && height < minimumEventHeight) {\n            height = minimumEventHeight;\n        }\n        var bottom = top + height;\n        var overlappingPreviousEvents = getOverLappingWeekViewEvents(previousDayEvents, top, bottom);\n        var left = 0;\n        while (overlappingPreviousEvents.some(function (previousEvent) { return previousEvent.left === left; })) {\n            left += eventWidth;\n        }\n        var dayEvent = {\n            event: event,\n            height: height,\n            width: eventWidth,\n            top: top,\n            left: left,\n            startsBeforeDay: startsBeforeDay,\n            endsAfterDay: endsAfterDay,\n        };\n        previousDayEvents.push(dayEvent);\n        return dayEvent;\n    });\n    var width = Math.max.apply(Math, dayViewEvents.map(function (event) { return event.left + event.width; }));\n    var allDayEvents = getEventsInPeriod(dateAdapter, {\n        events: events.filter(function (event) { return event.allDay; }),\n        periodStart: startOfDay(startOfView),\n        periodEnd: endOfDay(endOfView),\n    });\n    return {\n        events: dayViewEvents,\n        width: width,\n        allDayEvents: allDayEvents,\n        period: {\n            events: eventsInPeriod,\n            start: startOfView,\n            end: endOfView,\n        },\n    };\n}\nfunction sanitiseHours(hours) {\n    return Math.max(Math.min(23, hours), 0);\n}\nfunction sanitiseMinutes(minutes) {\n    return Math.max(Math.min(59, minutes), 0);\n}\nfunction getDayViewHourGrid(dateAdapter, _a) {\n    var viewDate = _a.viewDate, hourSegments = _a.hourSegments, hourDuration = _a.hourDuration, dayStart = _a.dayStart, dayEnd = _a.dayEnd;\n    var setMinutes = dateAdapter.setMinutes, setHours = dateAdapter.setHours, startOfDay = dateAdapter.startOfDay, startOfMinute = dateAdapter.startOfMinute, endOfDay = dateAdapter.endOfDay, addMinutes = dateAdapter.addMinutes, addHours = dateAdapter.addHours, addDays = dateAdapter.addDays;\n    var hours = [];\n    var startOfView = setMinutes(setHours(startOfDay(viewDate), sanitiseHours(dayStart.hour)), sanitiseMinutes(dayStart.minute));\n    var endOfView = setMinutes(setHours(startOfMinute(endOfDay(viewDate)), sanitiseHours(dayEnd.hour)), sanitiseMinutes(dayEnd.minute));\n    var segmentDuration = (hourDuration || MINUTES_IN_HOUR) / hourSegments;\n    var startOfViewDay = startOfDay(viewDate);\n    var endOfViewDay = endOfDay(viewDate);\n    var dateAdjustment = function (d) { return d; };\n    // this means that we change from or to DST on this day and that's going to cause problems so we bump the date\n    if (startOfViewDay.getTimezoneOffset() !== endOfViewDay.getTimezoneOffset()) {\n        startOfViewDay = addDays(startOfViewDay, 1);\n        startOfView = addDays(startOfView, 1);\n        endOfView = addDays(endOfView, 1);\n        dateAdjustment = function (d) { return addDays(d, -1); };\n    }\n    var dayDuration = hourDuration\n        ? (HOURS_IN_DAY * 60) / hourDuration\n        : MINUTES_IN_HOUR;\n    for (var i = 0; i < dayDuration; i++) {\n        var segments = [];\n        for (var j = 0; j < hourSegments; j++) {\n            var date = addMinutes(addMinutes(startOfView, i * (hourDuration || MINUTES_IN_HOUR)), j * segmentDuration);\n            if (date >= startOfView && date < endOfView) {\n                segments.push({\n                    date: dateAdjustment(date),\n                    displayDate: date,\n                    isStart: j === 0,\n                });\n            }\n        }\n        if (segments.length > 0) {\n            hours.push({ segments: segments });\n        }\n    }\n    return hours;\n}\nexport var EventValidationErrorMessage;\n(function (EventValidationErrorMessage) {\n    EventValidationErrorMessage[\"NotArray\"] = \"Events must be an array\";\n    EventValidationErrorMessage[\"StartPropertyMissing\"] = \"Event is missing the `start` property\";\n    EventValidationErrorMessage[\"StartPropertyNotDate\"] = \"Event `start` property should be a javascript date object. Do `new Date(event.start)` to fix it.\";\n    EventValidationErrorMessage[\"EndPropertyNotDate\"] = \"Event `end` property should be a javascript date object. Do `new Date(event.end)` to fix it.\";\n    EventValidationErrorMessage[\"EndsBeforeStart\"] = \"Event `start` property occurs after the `end`\";\n})(EventValidationErrorMessage || (EventValidationErrorMessage = {}));\nexport function validateEvents(events, log) {\n    var isValid = true;\n    function isError(msg, event) {\n        log(msg, event);\n        isValid = false;\n    }\n    if (!Array.isArray(events)) {\n        log(EventValidationErrorMessage.NotArray, events);\n        return false;\n    }\n    events.forEach(function (event) {\n        if (!event.start) {\n            isError(EventValidationErrorMessage.StartPropertyMissing, event);\n        }\n        else if (!(event.start instanceof Date)) {\n            isError(EventValidationErrorMessage.StartPropertyNotDate, event);\n        }\n        if (event.end) {\n            if (!(event.end instanceof Date)) {\n                isError(EventValidationErrorMessage.EndPropertyNotDate, event);\n            }\n            if (event.start > event.end) {\n                isError(EventValidationErrorMessage.EndsBeforeStart, event);\n            }\n        }\n    });\n    return isValid;\n}\n//# sourceMappingURL=calendar-utils.js.map"]},"metadata":{},"sourceType":"module"}